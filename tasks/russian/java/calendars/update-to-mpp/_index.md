---
date: 2025-12-03
description: Узнайте, как создавать календарь в MS Project, конвертировать проект
  в MPP и без труда сохранять проект в формате MPP с помощью Aspose.Tasks для Java.
linktitle: Update Calendar to MPP Format in Aspose.Tasks
second_title: Aspose.Tasks Java API
title: Создать календарь MS Project и сохранить как MPP с Aspose.Tasks
url: /ru/java/calendars/update-to-mpp/
weight: 16
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Создание календаря MS Project и сохранение в MPP с Aspose.Tasks

## Введение

В современном управлении проектами часто требуется **создавать файлы календаря MS Project** и затем делиться ими в нативном формате MPP. Независимо от того, объединяете ли вы расписания из разных источников или мигрируете устаревшие данные, возможность программно генерировать календарь экономит время и устраняет ручные ошибки. Этот учебник проведёт вас через весь процесс создания календаря в MS Project, его настройки и, наконец, **конвертации проекта в MPP** с использованием Java‑API Aspose.Tasks.

## Быстрые ответы
- **Что покрывает данный учебник?** Создание календаря в MS Project и сохранение его в файл MPP с помощью Aspose.Tasks для Java.  
- **Нужна ли лицензия?** Бесплатная пробная версия подходит для разработки; коммерческая лицензия требуется для продакшн.  
- **Какая версия Java требуется?** Java 8 или выше (JDK 8+).  
- **Можно ли настроить календарь?** Да — можно добавить рабочие часы, исключения и праздники.  
- **Сколько времени занимает реализация?** Около 10‑15 минут для базового календаря.

## Что такое “создание календаря MS Project”?

Создание календаря MS Project означает программное определение рабочих дней, часов и исключений, которые управляют планированием задач внутри файла Microsoft Project. С помощью Aspose.Tasks вы можете создавать, изменять и сохранять такие календари, не открывая пользовательский интерфейс Microsoft Project.

## Почему использовать Aspose.Tasks для этой задачи?

- **Полная совместимость с .NET/Java** — работает на любой платформе, поддерживающей Java.  
- **Не требуется установка COM или Office** — идеально для серверной автоматизации.  
- **Богатый API** — поддерживает все свойства календаря, включая пользовательские рабочие недели и праздники.  
- **Прямой вывод в MPP** — вы можете **сохранить проект в MPP** без промежуточных конвертаций.

## Предварительные требования

1. **Java Development Kit (JDK) 8+** — убедитесь, что `java -version` выводит 1.8 или новее.  
2. **Aspose.Tasks for Java** — скачайте последнюю JAR‑файл с [веб‑сайта Aspose](https://releases.aspose.com/tasks/java/).  
3. **IDE** — IntelliJ IDEA, Eclipse или любой предпочитаемый редактор.  
4. **Базовые знания Java** — знакомство с классами, методами и вводом‑выводом файлов.

## Пошаговое руководство

### Шаг 1: Импортировать необходимые пакеты

Сначала импортируйте классы Aspose.Tasks и утилиты Java в область видимости.

```java
import com.aspose.tasks.*;

import java.util.Date;
import java.util.GregorianCalendar;
```

### Шаг 2: Настроить каталог данных

Определите, где будут находиться ваш шаблон входных данных и файлы вывода. Замените заполнитель реальным путём на вашем компьютере.

```java
String dataDir = "Your Data Directory";
```

### Шаг 3: Определить имена входного и выходного файлов

Мы загрузим существующий файл MPP (или пустой проект) и запишем результат в новый файл.

```java
String resultFile = "OutputMpp.mpp";
String newFile = "SampleMpp.mpp";
```

### Шаг 4: Загрузить проект и добавить новый календарь

Создайте экземпляр `Project` из исходного файла и добавьте календарь с именем **«Calendar 1»**.

```java
Project project = new Project(dataDir + newFile);
Calendar cal1 = project.getCalendars().add("Calendar 1");
```

### Шаг 5: Настроить календарь (необязательно)

Если вам нужны специфические рабочие часы, праздники или исключения, вызовите собственный вспомогательный метод. В примере используется `GetTestCalendar` как заполнитель.

```java
GetTestCalendar(cal1); // Additional method for customizing calendar if required
```

> **Подсказка:** Вы можете напрямую изменять `cal1.getWeekDays()`, чтобы задать рабочие часы для каждого дня недели.

### Шаг 6: Присвоить календарь проекту

Укажите проекту использовать только что созданный календарь для всех расчётов планирования.

```java
project.set(Prj.CALENDAR, cal1);
```

### Шаг 7: Сохранить проект в формате MPP

Теперь **конвертируйте проект в MPP**, сохранив его с опцией `SaveFileFormat.Mpp`.

```java
project.save(dataDir + resultFile, SaveFileFormat.Mpp);
```

### Шаг 8: Подтвердить успешное завершение

Простое сообщение в консоли сообщит, что процесс завершён без ошибок.

```java
System.out.println("Process completed Successfully");
```

## Распространённые сценарии использования

- **Автоматическое генерирование расписаний** для повторяющихся проектов (например, еженедельные спринты).  
- **Миграция устаревших календарей CSV или Excel** в полностью функциональный файл MS Project.  
- **Серверная отчётность**, когда веб‑служба возвращает файл MPP по запросу.  

## Устранение неполадок и типичные подводные камни

| Проблема | Причина | Решение |
|----------|---------|---------|
| `NullPointerException` при `project.save` | `dataDir` указывает на несуществующую папку | Убедитесь, что каталог существует, либо создайте его программно. |
| Календарь не применён к задачам | Задачи всё ещё ссылаются на календарь по умолчанию | После установки `Prj.CALENDAR` также обновите `Task.CALENDAR` каждой задачи, если он был переопределён ранее. |
| Выходной файл 0 KB | Отсутствуют права записи | Запустите JVM с соответствующими правами доступа к файловой системе или выберите путь, доступный для записи. |

## Часто задаваемые вопросы

**Q: Совместим ли Aspose.Tasks for Java с разными версиями MS Project?**  
A: Да, Aspose.Tasks for Java поддерживает широкий диапазон версий MS Project, от Project 2007 до последнего выпуска, обеспечивая бесшовную совместимость.

**Q: Можно ли настраивать календари в соответствии с конкретными требованиями проекта?**  
A: Абсолютно. Вы можете определять рабочие дни, задавать пользовательские рабочие недели, добавлять праздники и даже создавать несколько календарей в одном файле проекта.

**Q: Предоставляет ли Aspose.Tasks for Java поддержку по устранению неполадок и помощи?**  
A: Да, вы можете получить помощь на форуме сообщества Aspose.Tasks [здесь](https://forum.aspose.com/c/tasks/15).

**Q: Есть ли бесплатная пробная версия Aspose.Tasks for Java?**  
A: Да, полностью функциональная бесплатная пробная версия доступна [здесь](https://releases.aspose.com/).

**Q: Как получить временную лицензию для Aspose.Tasks for Java?**  
A: Временные лицензии можно запросить через веб‑сайт Aspose [здесь](https://purchase.aspose.com/temporary-license/).

**Последнее обновление:** 2025-12-03  
**Тестировано с:** Aspose.Tasks for Java 24.12  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}