---
date: 2025-12-07
description: Узнайте, как **создать тестовый проект** и **добавить пользовательское
  поле**, работая с файлами Microsoft Project с помощью Aspose.Tasks для Java.
linktitle: Work with Formulas in Aspose.Tasks
second_title: Aspose.Tasks Java API
title: Создайте тестовый проект и используйте формулы с Aspose.Tasks для Java
url: /ru/java/formulas/work-with-formulas/
weight: 11
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Создать тестовый проект и использовать формулы с Aspose.Tasks для Java

## Введение
В этом руководстве вы **создадите тестовый проект**, добавите пользовательское поле и будете работать с формулами MS Project, используя библиотеку Aspose.Tasks для Java. Aspose.Tasks упрощает **манипулирование данными Microsoft Project** программно — будь то генерация расписаний, расчёт дат или автоматизация отчётности. К концу руководства у вас будет рабочий пример, который определяет расширенный атрибут, задаёт срок выполнения задачи и сохраняет проект в файл MPP.

## Быстрые ответы
- **Что покрывает руководство?** Создание тестового проекта, добавление пользовательского поля, определение расширенного атрибута и установка срока задачи с помощью формулы.  
- **Какая библиотека требуется?** Aspose.Tasks для Java (последняя версия).  
- **Нужна ли лицензия?** Бесплатная пробная версия подходит для разработки; для продакшна требуется лицензия.  
- **Какую IDE можно использовать?** Любую Java‑IDE (IntelliJ IDEA, Eclipse, VS Code), поддерживающую JDK 8+.  
- **Сколько времени займет реализация?** Около 10‑15 минут на копирование кода и его запуск.

## Что такое «Тестовый проект» в Aspose.Tasks?
**Тестовый проект** — это лёгкий файл Microsoft Project, созданный программно для демонстрации или проверки функциональности. Он содержит минимальный набор задач, ресурсов и пользовательских полей, которыми можно управлять, не затрагивая реальные данные проекта.

## Почему стоит использовать Aspose.Tasks для работы с Microsoft Project?
- **Полное покрытие API** — доступ ко всем свойствам Project, Task и Resource.  
- **Не требуется установка Office** — работает на серверах, в CI‑конвейерах и Docker‑контейнерах.  
- **Кросс‑платформенность** — работает в Windows, Linux и macOS с тем же Java‑кодом.  
- **Надёжный движок формул** — вычисление дат, длительностей и пользовательских полей непосредственно в файле проекта.

## Предварительные требования
Прежде чем начать, убедитесь, что у вас есть следующее:

- **Java Development Kit (JDK) 8+** — скачайте с сайта Oracle или используйте OpenJDK.  
- **Aspose.Tasks для Java** — получите последнюю JAR‑файл со [страницы загрузки Aspose.Tasks для Java](https://releases.aspose.com/tasks/java/) и добавьте её в classpath вашего проекта или в зависимости Maven/Gradle.

## Импорт пакетов
Сначала импортируем необходимые классы:

```java
import com.aspose.tasks.*;
import java.util.Calendar;
```

## Пошаговое руководство

### Шаг 1: Создать тестовый проект с пользовательским полем
Мы начинаем с **создания тестового проекта** и добавления пользовательского поля, которое позже будет содержать результат формулы.

```java
Project project = CreateTestProjectWithCustomField();
```

> *Совет:* `CreateTestProjectWithCustomField()` — вспомогательный метод, который формирует минимальное расписание и регистрирует расширенный атрибут, готовый к назначению формулы.

### Шаг 2: Определить расширенный атрибут (добавить пользовательское поле)
Далее мы **определяем расширенный атрибут** — по сути пользовательское поле — и задаём ему удобный псевдоним. Здесь происходит логика **добавления пользовательского поля**.

```java
ExtendedAttributeDefinition attr = project.getExtendedAttributes().get(0);
attr.setAlias("Days from finish to deadline");
attr.setFormula("[Deadline] - [Finish]");
```

- **Alias** делает поле читаемым в Project.  
- **Formula** вычисляет количество дней между датой *Finish* задачи и её *Deadline*.

### Шаг 3: Установить срок задачи (добавить задачу‑срок и задать срок задачи)
Теперь мы **добавляем данные о сроке задачи**, задавая свойство *Deadline* для конкретной задачи.

```java
java.util.Calendar cal = java.util.Calendar.getInstance();
cal.set(2015, Calendar.MARCH, 26, 8, 0, 0);
Task task = project.getRootTask().getChildren().getById(1);
task.set(Tsk.DEADLINE, cal.getTime());
```

- Экземпляр `Calendar` определяет точный момент срока.  
- `set(Tsk.DEADLINE, …)` **устанавливает срок задачи** для выбранной задачи.

### Шаг 4: Сохранить проект (манипулировать файлом Microsoft Project)
Наконец, мы **манипулируем Microsoft Project**, сохраняя изменения в файл MPP.

```java
project.save("SaveFile.mpp", SaveFileFormat.Mpp);
```

Вы можете открыть `SaveFile.mpp` в Microsoft Project, чтобы увидеть пользовательское поле, результат формулы и установленный срок в расписании.

## Распространённые проблемы и решения
| Проблема | Решение |
|----------|---------|
| **Формула не вычисляется** | Убедитесь, что строка `Formula` атрибута использует правильные имена полей (например, `[Deadline]`, `[Finish]`). |
| **Задача не найдена** | Проверьте, что ID задачи (`1` в примере) существует; для отладки используйте `project.getRootTask().getChildren().size()`. |
| **Исключение лицензии** | Примените действующую лицензию Aspose.Tasks перед вызовом любых методов API (`License license = new License(); license.setLicense("Aspose.Tasks.lic");`). |

## Часто задаваемые вопросы

**В: Можно ли использовать Aspose.Tasks с другими языками программирования?**  
О: Да, Aspose.Tasks предоставляет API для .NET, Java и других платформ, позволяя **манипулировать файлами Microsoft Project** на выбранном языке.

**В: Доступна ли бесплатная пробная версия Aspose.Tasks?**  
О: Конечно. Скачайте полностью функциональную пробную версию со [страницы загрузки Aspose.Tasks](https://releases.aspose.com/).

**В: Где найти подробную документацию по Aspose.Tasks?**  
О: Официальная документация размещена на [Aspose.Tasks Java API Reference](https://reference.aspose.com/tasks/java/).

**В: Как получить поддержку по Aspose.Tasks?**  
О: Посетите [форум Aspose.Tasks](https://forum.aspose.com/c/tasks/15), где можно задавать вопросы и делиться опытом с сообществом.

**В: Нужна ли временная лицензия для оценки?**  
О: Временная лицензия доступна для краткосрочного тестирования; запросить её можно [здесь](https://purchase.aspose.com/temporary-license/).

---

**Последнее обновление:** 2025-12-07  
**Тестировано с:** Aspose.Tasks для Java 24.12 (последняя на момент написания)  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}