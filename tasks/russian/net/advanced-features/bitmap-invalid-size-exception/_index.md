---
title: Обработка исключения недопустимого размера для растрового изображения в Aspose.Tasks
linktitle: Обработка исключения недопустимого размера для растрового изображения в Aspose.Tasks
second_title: Aspose.Tasks .NET API
description: Узнайте, как обрабатывать исключение BitmapInvalidSizeException в Aspose.Tasks для .NET при сохранении проектов в виде изображений. Подробное руководство с пошаговыми инструкциями.
weight: 22
url: /ru/net/advanced-features/bitmap-invalid-size-exception/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Обработка исключения недопустимого размера для растрового изображения в Aspose.Tasks

## Введение

 В этом уроке мы углубимся в обработку`BitmapInvalidSizeException` при работе с Aspose.Tasks для .NET. Aspose.Tasks — это мощная библиотека, которая позволяет разработчикам программно манипулировать файлами Microsoft Project, выполняя такие задачи, как сохранение проектов в виде изображений. Однако иногда при попытке сохранить проект в виде изображения мы можем столкнуться с ошибкой.`Invalid Size Exception`связанный с растровым изображением. Цель этого руководства — помочь вам эффективно перехватить и обработать это исключение.

## Предварительные условия

Прежде чем продолжить работу с этим руководством, убедитесь, что у вас есть следующие предварительные условия:
1. Базовое понимание языка программирования C#.
2. Установлен Aspose.Tasks для .NET.
3. Навыки работы с файлами Microsoft Project.

## Импортировать пространства имен

Прежде чем начать, обязательно импортируйте необходимые пространства имен:
```csharp
using Aspose.Tasks;
using System;

using Aspose.Tasks.Saving;
using Aspose.Tasks.Visualization;

```

## Шаг 1. Инициализация проекта и определение представления

 Во-первых, инициализируйте`Project` объект и определить представление, например`GanttChartView`.

```csharp
// Путь к каталогу документов.
String DataDir = "Your Document Directory";
var project = new Project(DataDir + "Blank2010.mpp");
GanttChartView view = (GanttChartView) project.Views.ToList()[0];
```

## Шаг 2. Укажите параметры сохранения изображения.

Далее укажите параметры сохранения изображения, включая формат и временные рамки.

```csharp
var options = new ImageSaveOptions(SaveFileFormat.Png)
{
    Timescale = Timescale.DefinedInView
};
```

## Шаг 3. Установите единицу измерения и количество временной шкалы

Настройте единицу измерения времени и рассчитывайте в соответствии с вашими требованиями. В этом примере мы установили шкалу времени в минутах.

```csharp
view.MiddleTimescaleTier.Unit = TimescaleUnit.Minutes;
view.MiddleTimescaleTier.Count = 1;
```

## Шаг 4. Сохраните проект как изображение

Попытайтесь сохранить проект как изображение, используя указанные параметры.

```csharp
project.Save(DataDir + "SaveToStreamAndCatchException_out.mpp", options);
```

## Шаг 5. Перехват и обработка исключений

 Реализуйте обработку исключений, чтобы перехватить`BitmapInvalidSizeException` если это происходит во время процесса сохранения изображения.

```csharp
try
{
    // Попытайтесь сохранить проект как изображение.
    project.Save(DataDir + "SaveToStreamAndCatchException_out.mpp", options);
}
catch (BitmapInvalidSizeException ex)
{
    // Обработка исключения
    Console.WriteLine(ex.Message);
}
```

## Заключение

 В заключение, обработка`BitmapInvalidSizeException` сохранение проектов в виде изображений в Aspose.Tasks for .NET имеет решающее значение для обеспечения бесперебойной работы ваших приложений. Следуя шагам, описанным в этом руководстве, вы сможете эффективно перехватывать и обрабатывать это исключение, тем самым повышая надежность ваших решений по управлению проектами.

## Часто задаваемые вопросы

### Вопрос 1. Что вызывает исключение BitmapInvalidSizeException в Aspose.Tasks?

A1: Это исключение возникает при попытке сохранить проект как изображение с недопустимыми параметрами размера растрового изображения.

### Вопрос 2. Могу ли я настроить временную шкалу при сохранении проекта в виде изображения?

О2: Да, вы можете настроить единицы измерения времени и подсчет в соответствии с вашими требованиями, как показано в руководстве.

### Вопрос 3. Где я могу найти дополнительные ресурсы для работы с Aspose.Tasks для .NET?

О3: Вы можете изучить документацию и форумы поддержки, предоставляемые Aspose.Tasks, для получения всесторонних рекомендаций и помощи.

### Вопрос 4. Совместим ли Aspose.Tasks с различными версиями файлов Microsoft Project?

О4: Да, Aspose.Tasks поддерживает различные версии файлов Microsoft Project, обеспечивая беспрепятственную совместимость.

### В5: Как я могу получить временную лицензию для Aspose.Tasks?

О5: Вы можете приобрести временную лицензию для ознакомительных целей по ссылке в статье.
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
