---
date: 2025-12-04
description: เรียนรู้วิธีตั้งค่าปฏิทินโครงการและจัดการคุณสมบัติปฏิทินของ MS Project
  ใน Java ด้วย Aspose.Tasks คู่มือแบบขั้นตอนเพื่อแสดงชั่วโมงทำงานของปฏิทินและปรับแต่งกำหนดการ
language: th
linktitle: Manage Calendar Properties in Aspose.Tasks
second_title: Aspose.Tasks Java API
title: วิธีตั้งปฏิทินโครงการด้วย Aspose.Tasks สำหรับ Java
url: /java/calendars/properties/
weight: 10
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# วิธีตั้งปฏิทินโครงการด้วย Aspose.Tasks สำหรับ Java

## คำแนะนำ
ในบทเรียนนี้คุณจะได้เรียนรู้ **วิธีตั้งปฏิทินโครงการ** อย่างโปรแกรมโดยใช้ไลบรารี Aspose.Tasks สำหรับ Java การควบคุมคุณสมบัติของปฏิทินช่วยให้คุณ **แสดงชั่วโมงทำงานของปฏิทิน**, กำหนดวันทำงานแบบกำหนดเอง, และทำให้กำหนดการของโครงการสอดคล้องกับข้อจำกัดในโลกจริง เราจะเดินผ่านทุกขั้นตอน—from การตั้งค่าสภาพแวดล้อมจนถึงการวนลูปผ่านปฏิทินและอ่านคุณสมบัติของมัน—เพื่อให้คุณสามารถจัดการปฏิทิน MS Project ในแอปพลิเคชันของคุณได้อย่างมั่นใจ

## คำตอบสั้น
- **“ตั้งปฏิทินโครงการ” หมายถึงอะไร?** หมายถึงการสร้างหรืออัปเดตเวลาทำงานของปฏิทิน, ปฏิทินฐาน, และประเภทวันภายในไฟล์ MS Project  
- **ต้องใช้ไลบรารีใด?** Aspose.Tasks สำหรับ Java (เวอร์ชันล่าสุดใดก็ได้)  
- **ต้องมีลิขสิทธิ์หรือไม่?** สามารถใช้รุ่นทดลองฟรีสำหรับการพัฒนา; ต้องมีลิขสิทธิ์เชิงพาณิชย์สำหรับการใช้งานจริง  
- **สามารถแสดงชั่วโมงทำงานของปฏิทินได้หรือไม่?** ได้—โดยอ่านแต่ละ `WeekDay` คุณสามารถแสดงชั่วโมงสำหรับแต่ละประเภทวันได้  
- **รองรับ Maven/Gradle หรือไม่?** แน่นอน—เพิ่ม JAR ของ Aspose.Tasks เป็น dependency

## ปฏิทินโครงการคืออะไร?
ปฏิทินโครงการกำหนดวันทำงานและชั่วโมงทำงานสำหรับงาน, ทรัพยากร, และไทม์ไลน์ของโครงการทั้งหมด ใน MS Project ปฏิทินสามารถสืบทอดจากปฏิทินฐาน, และแต่ละประเภทวัน (เช่น **Standard**, **Non‑working**) สามารถมีเวลาทำงานของตนเอง การจัดการการตั้งค่าเหล่านี้ด้วยโปรแกรมทำให้สามารถปรับกำหนดการแบบไดนามิกโดยไม่ต้องแก้ไขด้วยตนเอง

## ทำไมต้องจัดการปฏิทิน MS Project ด้วยโปรแกรม?
- **อัตโนมัติ:** ปรับปฏิทินหลายโครงการด้วยสคริปต์เดียว  
- **ความสอดคล้อง:** บังคับใช้นโยบายเวลาทำงานระดับองค์กร  
- **การบูรณาการ:** ซิงค์ปฏิทินกับระบบภายนอก (HR, ERP)  
- **การมองเห็น:** แสดง **ชั่วโมงทำงานของปฏิทิน** อย่างรวดเร็วสำหรับการรายงานหรือดีบัก

## ข้อกำหนดเบื้องต้น
ก่อนเริ่มทำตามขั้นตอนต่อไปนี้ให้ตรวจสอบว่าคุณมี:

- **Java Development Kit (JDK) 8+** ติดตั้งและตั้งค่า `JAVA_HOME` แล้ว  
- **Aspose.Tasks สำหรับ Java** ดาวน์โหลดจาก [download page](https://releases.aspose.com/tasks/java/) เพิ่ม JAR ไปยัง classpath ของโปรเจกต์หรือเป็น dependency ของ Maven/Gradle  

## นำเข้าแพ็กเกจ
ก่อนอื่นให้นำเข้าคลาสหลักของ Aspose.Tasks ที่เราจะใช้ตลอดบทเรียน:

```java
import com.aspose.tasks.*;
```

## ขั้นตอนที่ 1: ตั้งค่าโฟลเดอร์ข้อมูล
กำหนดโฟลเดอร์ที่เก็บไฟล์โครงการของคุณ แทนที่ค่า placeholder ด้วยพาธจริงบนเครื่องของคุณ

```java
String dataDir = "Your Data Directory";
```

## ขั้นตอนที่ 2: กำหนดหน่วยเวลา
เวลาทำงานระบุเป็นมิลลิวินาที การกำหนดค่าคงที่ที่ใช้ซ้ำทำให้โค้ดอ่านง่ายขึ้น

```java
long OneSec = 1000; // 1000 milliseconds
long OneMin = 60 * OneSec;
long OneHour = 60 * OneMin;
```

## ขั้นตอนที่ 3: โหลดข้อมูลโครงการ
สร้างอินสแตนซ์ `Project` โดยโหลดไฟล์ XML ของ MS Project ที่มีอยู่ (`.xml` หรือ `.mpp`) ซึ่งให้เราสามารถเข้าถึงปฏิทินทั้งหมดที่เก็บไว้ในไฟล์ได้

```java
Project project = new Project(dataDir + "project.xml");
```

## ขั้นตอนที่ 4: วนลูปผ่านปฏิทินและแสดงชั่วโมงทำงาน
ตอนนี้เราจะวนลูปผ่านทุกปฏิทิน, พิมพ์ UID, ชื่อ, ปฏิทินฐาน, และชั่วโมงทำงานสำหรับแต่ละประเภทวัน ซึ่งแสดง **วิธีตั้งปฏิทินโครงการ** และ **วิธีแสดงชั่วโมงทำงานของปฏิทิน** ด้วย

```java
for (Calendar cal : project.getCalendars()) {
    if (cal.getName() == null) {
        continue;
    }
    System.out.println("UID: " + cal.getUid() + " Name: " + cal.getName());
    // Show if it has a base calendar
    System.out.print("Base Calendar: ");
    System.out.println(cal.isBaseCalendar() ? "Self" : cal.getBaseCalendar().getName());
    // Iterate through weekdays
    for (WeekDay wd : cal.getWeekDays()) {
        double ts = wd.getWorkingTime();
        System.out.println("Day Type: " + DayType.toString(DayType.class, wd.getDayType()) + " Hours: " + ts / OneHour);
    }
}
```

### สิ่งที่โค้ดนี้ทำ
- **กรองปฏิทินที่ไม่มีชื่อ** (บางปฏิทินภายในอาจมีค่า `null`)  
- **พิมพ์ UID และชื่อ** – มีประโยชน์สำหรับระบุตัวปฏิทินในภายหลัง  
- **แสดงปฏิทินฐาน** – เป็น “Self” (ปฏิทินเป็นฐานของตนเอง) หรือชื่อของปฏิทินที่สืบทอดมา  
- **วนลูปผ่านแต่ละ `WeekDay`** เพื่อคำนวณและแสดงชั่วโมงทำงานรวม (`workingTime` อยู่ในมิลลิวินาที จึงต้องหารด้วย `OneHour`)  

## ปัญหาที่พบบ่อยและวิธีแก้
| ปัญหา | สาเหตุ | วิธีแก้ |
|-------|--------|--------|
| `NullPointerException` ที่ `cal.getBaseCalendar()` | ปฏิทินเป็นปฏิทินฐานเอง (`isBaseCalendar()` คืนค่า `true`) | ใช้การตรวจสอบแบบ ternary ตามที่แสดง (`cal.isBaseCalendar() ? "Self" : ...`) |
| ไม่แสดงชั่วโมงทำงาน | ไฟล์โครงการใช้หน่วยเวลาอื่น (ticks) | ตรวจสอบรูปแบบไฟล์; Aspose.Tasks จะทำให้เป็นมิลลิวินาที แต่ต้องแน่ใจว่าโหลดไฟล์ประเภทที่ถูกต้อง |
| ไม่พบ `project.xml` | พาธ `dataDir` ไม่ถูกต้อง | ใช้พาธ absolute หรือ `Paths.get(dataDir, "project.xml").toString()` |

## คำถามที่พบบ่อย

**ถาม: สามารถแก้ไขคุณสมบัติของปฏิทินด้วยโปรแกรมโดยใช้ Aspose.Tasks ได้หรือไม่?**  
ตอบ: ได้, API ให้การเข้าถึงแบบอ่าน/เขียนเต็มรูปแบบกับปฏิทิน, สามารถเพิ่ม, แก้ไข, หรือ ลบ เวลาทำงาน, ข้อยกเว้น, และความสัมพันธ์ของปฏิทินฐานได้

**ถาม: มีข้อจำกัดใดในการปรับแต่งปฏิทินด้วย Aspose.Tasks หรือไม่?**  
ตอบ: ไลบรารีจำลองความสามารถของ Microsoft Project อย่างครบถ้วน, สามารถปรับแต่งส่วนเกือบทั้งหมดของปฏิทิน; เวอร์ชันไฟล์ Project เก่ามากอาจมีข้อแตกต่างเล็กน้อย

**ถาม: สามารถบูรณาการการจัดการปฏิทินเข้ากับโปรเจกต์ Java ที่มีอยู่แล้วได้หรือไม่?**  
ตอบ: แน่นอน, เพียงเพิ่ม JAR ของ Aspose.Tasks ไปยัง build path แล้วใช้โค้ดตัวอย่างที่แสดงในบทเรียนนี้

**ถาม: Aspose.Tasks รองรับฟังก์ชันการจัดการโครงการอื่น ๆ นอกจากการจัดการปฏิทินหรือไม่?**  
ตอบ: รองรับงาน, ทรัพยากร, การมอบหมาย, โครงร่าง, baseline, และอื่น ๆ อีกมาก ทำให้เป็นโซลูชันครบวงจรสำหรับการอัตโนมัติโครงการด้วย Java

**ถาม: มีการสนับสนุนทางเทคนิคสำหรับนักพัฒนาที่ใช้ Aspose.Tasks หรือไม่?**  
ตอบ: มี, Aspose มีฟอรั่ม, การสนับสนุนทางอีเมล, และเอกสารละเอียดสำหรับผู้ใช้ที่มีลิขสิทธิ์ทั้งหมด

## สรุป
เมื่อทำตามคำแนะนำนี้แล้วคุณจะรู้ **วิธีตั้งปฏิทินโครงการ** อย่างถูกต้อง, อ่านและ **แสดงชั่วโมงทำงานของฏิทิน**, และนำความสามารถเหล่านี้ไปผสานในแอปพลิเคชัน Java ใด ๆ ด้วย Aspose.Tasks ซึ่งช่วยให้คุณอัตโนมัติการปรับกำหนดการ, บังคับใช้นโยบายเวลาทำงานที่สอดคล้อง, และสร้างโซลูชันการจัดการโครงการที่แข็งแกร่งยิ่งขึ้น

---

**อัปเดตล่าสุด:** 2025-12-04  
**ทดสอบกับ:** Aspose.Tasks สำหรับ Java 24.12 (ล่าสุด ณ เวลาที่เขียน)  
**ผู้เขียน:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}