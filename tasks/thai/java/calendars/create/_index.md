---
date: 2025-12-02
description: เรียนรู้วิธีเพิ่มปฏิทินลงในโครงการ, วิธีสร้างปฏิทิน MS Project, และบันทึกโครงการเป็น
  XML ด้วย Aspose.Tasks สำหรับ Java.
language: th
linktitle: Add Calendar to Project using Aspose.Tasks
second_title: Aspose.Tasks Java API
title: เพิ่มปฏิทินในโครงการด้วย Aspose.Tasks สำหรับ Java
url: /java/calendars/create/
weight: 11
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# เพิ่มปฏิทินในโครงการด้วย Aspose.Tasks for Java

## บทนำ
ในกระบวนการจัดการโครงการสมัยใหม่ ความสามารถในการ **เพิ่มปฏิทินในโครงการ** ผ่านโปรแกรมสามารถประหยัดเวลาการแก้ไขด้วยมือหลายชั่วโมง Aspose.Tasks for Java มอบ API ที่สะอาดและปลอดภัยต่อชนิดข้อมูลให้กับนักพัฒนาเพื่อจัดการไฟล์ Microsoft Project โดยไม่ต้องเปิดไคลเอนต์บนเดสก์ท็อป ในบทเรียนนี้คุณจะได้เรียนรู้ **วิธีเพิ่มปฏิทิน**, **วิธีสร้างปฏิทิน MS Project**, และ **การบันทึกโครงการเป็น XML** — ทั้งหมดด้วยเพียงไม่กี่บรรทัดของโค้ด Java

## คำตอบสั้น
- **“เพิ่มปฏิทินในโครงการ” หมายถึงอะไร?**  
  หมายถึงการแทรกการกำหนดเวลาการทำงานใหม่ (ปฏิทิน) เข้าไปในไฟล์ Microsoft Project ผ่านโค้ด  
- **ไลบรารีใดจัดการเรื่องนี้?**  
  Aspose.Tasks for Java ให้คลาส `Calendar` และคอนเทนเนอร์ `Project` เพื่อจัดการปฏิทิน  
- **ต้องใช้ลิขสิทธิ์หรือไม่?**  
  ลิขสิทธิ์ทดลองชั่วคราวใช้ได้สำหรับการทดสอบ; ต้องมีลิขสิทธิ์เต็มสำหรับการใช้งานในผลิตภัณฑ์จริง  
- **สามารถบันทึกไฟล์เป็น XML ได้หรือไม่?**  
  ได้ — ใช้ `SaveFileFormat.Xml` เพื่อส่งออกโครงการเป็นไฟล์ XML  
- **ข้อกำหนดเบื้องต้นคืออะไร?**  
  Java JDK 8+ และไฟล์ JAR ของ Aspose.Tasks for Java อยู่ใน classpath ของคุณ  

## “เพิ่มปฏิทินในโครงการ” คืออะไร?
การเพิ่มปฏิทินในโครงการสร้างตารางเวลาที่กำหนดเองซึ่งระบุวันทำงาน, วันหยุด, และชั่วโมงทำงานต่อวัน ปฏิทินนี้สามารถกำหนดให้กับงาน, ทรัพยากร, หรือทั้งโครงการ เพื่อให้การคำนวณเช่น วันที่เริ่มต้นและระยะเวลาต่าง ๆ เคารพตามเวลาการทำงานที่กำหนดไว้

## ทำไมต้องใช้ Aspose.Tasks for Java เพื่อเพิ่มปฏิทินในโครงการ?
- **การควบคุมเต็มรูปแบบ** – ไม่ต้องใช้ UI; สามารถทำการสร้างปฏิทินเป็นกลุ่มในหลายโครงการได้โดยอัตโนมัติ  
- **ความเข้ากันได้ข้ามเวอร์ชัน** – ทำงานกับไฟล์ Project 2007, 2010, 2013, 2016 และไฟล์รุ่นใหม่อื่น ๆ  
- **ไม่ต้องติดตั้ง Microsoft Project** – รันได้บนเซิร์ฟเวอร์หรือ pipeline CI ใดก็ได้  
- **ความยืดหยุ่นในการส่งออก** – บันทึกเป็น XML, MPP หรือรูปแบบที่รองรับอื่น ๆ  

## ข้อกำหนดเบื้องต้น
- **Java Development Kit (JDK) 8 หรือใหม่กว่า** ที่ติดตั้งและกำหนดค่าเรียบร้อย  
- **ไลบรารี Aspose.Tasks for Java** – ดาวน์โหลดจาก [เว็บไซต์อย่างเป็นทางการ](https://releases.aspose.com/tasks/java/) แล้วเพิ่มไฟล์ JAR ไปยัง classpath ของโปรเจกต์  
- IDE หรือเครื่องมือสร้าง (Maven/Gradle) ตามที่คุณเลือกใช้  

## คู่มือแบบขั้นตอน

### ขั้นตอนที่ 1: นำเข้าแพ็กเกจ Aspose.Tasks ที่จำเป็น
เริ่มต้นโดยนำเข้าคลาสของ Aspose.Tasks เพื่อให้คุณสามารถทำงานกับโครงการและปฏิทินได้

```java
import com.aspose.tasks.*;
```

### ขั้นตอนที่ 2: ตั้งค่าพาธไดเรกทอรีข้อมูล
กำหนดตำแหน่งที่ไฟล์โครงการที่สร้างขึ้นจะถูกเขียนออกไป แทนที่ตัวแปร placeholder ด้วยพาธแบบ absolute หรือ relative ที่เครื่องของคุณ

```java
String dataDir = "Your Data Directory";
```

### ขั้นตอนที่ 3: สร้างอินสแตนซ์ Project ใหม่
สร้างอ็อบเจกต์ `Project` – ซึ่งเป็นไฟล์ Microsoft Project ว่างเปล่าที่คุณสามารถเติมข้อมูลได้

```java
Project prj = new Project();
```

### ขั้นตอนที่ 4: กำหนดปฏิทินที่ต้องการเพิ่ม
ใช้เมธอด `Calendars.add(String name)` เพื่อสร้างรายการปฏิทินใหม่ ในตัวอย่างนี้เราจะเพิ่มสามปฏิทิน แต่คุณสามารถเพิ่มได้ตามต้องการและกำหนดเวลาการทำงานต่อภายหลัง

```java
Calendar cal1 = prj.getCalendars().add("no info");
Calendar cal2 = prj.getCalendars().add("no name");
Calendar cal3 = prj.getCalendars().add("cal3");
```

> **เคล็ดลับ:** หลังจากเพิ่มปฏิทินแล้ว คุณสามารถปรับวันทำงานด้วย `cal1.getWeekDays().add(...)` และตั้งชั่วโมงทำงานต่อวันด้วย `cal1.getBaseCalendar().setWorkingTime(...)`

### ขั้นตอนที่ 5: บันทึกโครงการ (บันทึกโครงการเป็น XML)
บันทึกโครงการรวมถึงปฏิทินที่เพิ่มใหม่ลงในไฟล์ XML รูปแบบนี้ง่ายต่อการตรวจสอบและเข้ากันได้กับเครื่องมือต่าง ๆ มากมาย

```java
prj.save(dataDir + "project.xml", SaveFileFormat.Xml);
```

### ขั้นตอนที่ 6: แสดงข้อความเสร็จสิ้น
แจ้งผู้ใช้ให้ทราบว่าการดำเนินการเสร็จสมบูรณ์

```java
System.out.println("Process completed Successfully");
```

โดยทำตามหกขั้นตอนสั้น ๆ นี้ คุณได้ **เพิ่มปฏิทินในโครงการ** และบันทึกผลลัพธ์เป็นไฟล์ XML เรียบร้อยแล้ว

## ปัญหาที่พบบ่อยและวิธีแก้
| ปัญหา | สาเหตุ | วิธีแก้ |
|-------|--------|-----|
| **`NullPointerException` ที่ `prj.getCalendars()`** | อ็อบเจกต์ Project ไม่ได้ถูกสร้างอย่างถูกต้อง | ตรวจสอบให้แน่ใจว่าเรียก `new Project()` ก่อนเข้าถึงปฏิทิน |
| **ไฟล์ไม่พบเมื่อบันทึก** | `dataDir` ชี้ไปยังโฟลเดอร์ที่ไม่มีอยู่ | สร้างโฟลเดอร์ก่อนหรือใช้พาธแบบ absolute |
| **ชื่อปฏิทินแสดงเป็น “no info”** | ใช้ชื่อ placeholder ในตัวอย่าง | แทนที่ด้วยชื่อที่มีความหมายสื่อถึงตารางเวลา (เช่น “US Holiday Calendar”) |
| **XML ที่บันทึกไม่เปิดใน MS Project** | ใช้เวอร์ชัน Aspose.Tasks ที่ล้าสมัย | อัปเดตเป็นเวอร์ชันล่าสุดของ Aspose.Tasks for Java |

## คำถามที่พบบ่อย

**ถาม: Aspose.Tasks สามารถจัดการปฏิทินที่ซับซ้อนพร้อมหลายข้อยกเว้นได้หรือไม่?**  
ตอบ: ได้ – หลังจากเพิ่มปฏิทินแล้ว คุณสามารถกำหนดข้อยกเว้น, ชั่วโมงทำงาน, และวันไม่ทำงานโดยใช้คลาส `WeekDay` และ `Exception`

**ถาม: สามารถกำหนดปฏิทินใหม่ให้กับงานเฉพาะได้หรือไม่?**  
ตอบ: แน่นอน. ดึงงานด้วย `prj.getRootTask().getChildren().add("Task Name")` แล้วตั้งค่า `task.set(Tsk.CALENDAR, cal3);`

**ถาม: ไลบรารีรองรับการบันทึกในรูปแบบอื่นเช่น MPP หรือไม่?**  
ตอบ: รองรับ. แทนที่ `SaveFileFormat.Xml` ด้วย `SaveFileFormat.Mpp` หรือ `SaveFileFormat.P6` ตามต้องการ

**ถาม: จำเป็นต้องมีลิขสิทธิ์สำหรับการสร้างบิลด์ในขั้นตอนพัฒนาไหม?**  
ตอบ: ลิขสิทธิ์ทดลองชั่วคราวเพียงพอสำหรับการทดสอบ; ต้องมีลิขสิทธิ์เต็มสำหรับการใช้งานในสภาพแวดล้อมผลิต

**ถาม: จะหาความช่วยเหลือได้จากที่ไหนหากเจอปัญหา?**  
ตอบ: ฟอรั่มชุมชน Aspose.Tasks เป็นแหล่งข้อมูลที่ดี: [Aspose.Tasks forum](https://forum.aspose.com/c/tasks/15)

## สรุป
ด้วย Aspose.Tasks for Java คุณสามารถ **เพิ่มปฏิทินในโครงการ** อย่างเป็นโปรแกรม, ปรับกฎการจัดตารางเวลา, และ **บันทึกโครงการเป็น XML** ได้ด้วยไม่กี่บรรทัดของโค้ด การทำอัตโนมัตินี้ช่วยลดความพยายามจากการทำมือ, ป้องกันข้อผิดพลาดของมนุษย์, และทำให้สามารถประมวลผลโครงการจำนวนมากได้อย่างเป็นชุด

---

**อัปเดตล่าสุด:** 2025-12-02  
**ทดสอบกับ:** Aspose.Tasks for Java 24.12 (ล่าสุด ณ เวลาที่เขียน)  
**ผู้เขียน:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}