---
date: 2025-12-03
description: เรียนรู้วิธีสร้างปฏิทินใน MS Project, แปลงโครงการเป็นไฟล์ MPP, และบันทึกไฟล์
  MPP ของโครงการได้อย่างง่ายดายด้วย Aspose.Tasks for Java.
linktitle: Update Calendar to MPP Format in Aspose.Tasks
second_title: Aspose.Tasks Java API
title: สร้างปฏิทิน MS Project และบันทึกเป็น MPP ด้วย Aspose.Tasks
url: /th/java/calendars/update-to-mpp/
weight: 16
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# สร้างปฏิทิน MS Project และบันทึกเป็น MPP ด้วย Aspose.Tasks

## บทนำ

ในการจัดการโครงการสมัยใหม่ คุณมักต้อง **สร้างไฟล์ปฏิทิน MS Project** แล้วแชร์ในรูปแบบ MPP ดั้งเดิม ไม่ว่าจะเป็นการรวมกำหนดการจากหลายแหล่งหรือการย้ายข้อมูลเก่า การสร้างปฏิทินโดยอัตโนมัติช่วยประหยัดเวลาและลดข้อผิดพลาดจากการทำมือ บทแนะนำนี้จะพาคุณผ่านกระบวนการทั้งหมดตั้งแต่การสร้างปฏิทินใน MS Project ปรับแต่ง แล้วสุดท้าย **แปลงโครงการเป็น MPP** ด้วย Aspose.Tasks Java API

## คำตอบสั้น
- **บทแนะนำนี้ครอบคลุมอะไร?** การสร้างปฏิทินใน MS Project และบันทึกเป็นไฟล์ MPP ด้วย Aspose.Tasks สำหรับ Java  
- **ต้องมีลิขสิทธิ์หรือไม่?** สามารถใช้รุ่นทดลองฟรีสำหรับการพัฒนา; ต้องมีลิขสิทธิ์เชิงพาณิชย์สำหรับการใช้งานจริง  
- **ต้องใช้ Java เวอร์ชันใด?** Java 8 หรือสูงกว่า (JDK 8+)  
- **สามารถปรับแต่งปฏิทินได้หรือไม่?** ได้ – สามารถเพิ่มเวลาทำงาน, ข้อยกเว้น, และวันหยุดได้  
- **ใช้เวลานานเท่าไหร่ในการทำงาน?** ประมาณ 10‑15 นาทีสำหรับปฏิทินพื้นฐาน

## “สร้างปฏิทิน MS Project” คืออะไร?

การสร้างปฏิทิน MS Project หมายถึงการกำหนดวันทำงาน, ชั่วโมงทำงาน, และข้อยกเว้นต่าง ๆ อย่างโปรแกรมเมติก ซึ่งเป็นตัวกำหนดการจัดตารางงานของงานภายในไฟล์ Microsoft Project โดยใช้ Aspose.Tasks คุณสามารถสร้าง, แก้ไข, และบันทึกปฏิทินเหล่านี้ได้โดยไม่ต้องเปิด UI ของ Microsoft Project

## ทำไมต้องใช้ Aspose.Tasks สำหรับงานนี้?

- **รองรับ .NET/Java อย่างเต็มรูปแบบ** – ทำงานบนแพลตฟอร์มใดก็ได้ที่สนับสนุน Java  
- **ไม่ต้องใช้ COM หรือการติดตั้ง Office** – เหมาะสำหรับการทำงานบนเซิร์ฟเวอร์  
- **API ครบถ้วน** – รองรับคุณสมบัติของปฏิทินทุกอย่าง รวมถึงสัปดาห์ทำงานแบบกำหนดเองและวันหยุด  
- **ส่งออกเป็น MPP โดยตรง** – คุณสามารถ **บันทึกโครงการเป็น MPP** ได้โดยไม่ต้องแปลงขั้นกลาง

## ข้อกำหนดเบื้องต้น

1. **Java Development Kit (JDK) 8+** – ตรวจสอบให้ `java -version` แสดง 1.8 หรือใหม่กว่า  
2. **Aspose.Tasks for Java** – ดาวน์โหลด JAR ล่าสุดจาก [Aspose website](https://releases.aspose.com/tasks/java/)  
3. **IDE** – IntelliJ IDEA, Eclipse หรือโปรแกรมแก้ไขที่คุณชื่นชอบ  
4. **ความรู้พื้นฐาน Java** – รู้จักคลาส, เมธอด, และการทำ I/O ของไฟล์

## คู่มือขั้นตอนโดยละเอียด

### ขั้นตอนที่ 1: นำเข้าแพ็กเกจที่จำเป็น

เริ่มต้นโดยนำคลาสของ Aspose.Tasks และยูทิลิตี้ของ Java เข้ามาใช้

```java
import com.aspose.tasks.*;

import java.util.Date;
import java.util.GregorianCalendar;
```

### ขั้นตอนที่ 2: ตั้งค่าโฟลเดอร์ข้อมูล

กำหนดตำแหน่งที่ไฟล์เทมเพลตและไฟล์ผลลัพธ์จะถูกเก็บไว้ แทนที่ placeholder ด้วยพาธจริงบนเครื่องของคุณ

```java
String dataDir = "Your Data Directory";
```

### ขั้นตอนที่ 3: กำหนดชื่อไฟล์อินพุตและเอาต์พุต

เราจะโหลดไฟล์ MPP ที่มีอยู่ (หรือโครงการเปล่า) แล้วเขียนผลลัพธ์ไปยังไฟล์ใหม่

```java
String resultFile = "OutputMpp.mpp";
String newFile = "SampleMpp.mpp";
```

### ขั้นตอนที่ 4: โหลดโครงการและเพิ่มปฏิทินใหม่

สร้างอินสแตนซ์ `Project` จากไฟล์ต้นทางและเพิ่มปฏิทินชื่อ **“Calendar 1”**

```java
Project project = new Project(dataDir + newFile);
Calendar cal1 = project.getCalendars().add("Calendar 1");
```

### ขั้นตอนที่ 5: ปรับแต่งปฏิทิน (ไม่บังคับ)

หากต้องการเวลาทำงาน, วันหยุด, หรือข้อยกเว้นเฉพาะ ให้เรียกเมธอดช่วยเหลือของคุณ ตัวอย่างใช้ `GetTestCalendar` เป็น placeholder

```java
GetTestCalendar(cal1); // Additional method for customizing calendar if required
```

> **เคล็ดลับ:** คุณสามารถจัดการ `cal1.getWeekDays()` โดยตรงเพื่อกำหนดชั่วโมงทำงานของแต่ละวันในสัปดาห์

### ขั้นตอนที่ 6: กำหนดปฏิทินให้กับโครงการ

บอกโครงการให้ใช้ปฏิทินที่สร้างใหม่สำหรับการคำนวณตารางทั้งหมด

```java
project.set(Prj.CALENDAR, cal1);
```

### ขั้นตอนที่ 7: บันทึกโครงการเป็น MPP

ตอนนี้ **แปลงโครงการเป็น MPP** โดยบันทึกด้วยตัวเลือก `SaveFileFormat.Mpp`

```java
project.save(dataDir + resultFile, SaveFileFormat.Mpp);
```

### ขั้นตอนที่ 8: ยืนยันการทำงานสำเร็จ

ข้อความคอนโซลง่าย ๆ จะบอกคุณว่ากระบวนการเสร็จสมบูรณ์โดยไม่มีข้อผิดพลาด

```java
System.out.println("Process completed Successfully");
```

## กรณีการใช้งานทั่วไป

- **การสร้างตารางอัตโนมัติ** สำหรับโครงการที่ทำซ้ำ (เช่น สปรินต์ประจำสัปดาห์)  
- **การย้ายปฏิทินจาก CSV หรือ Excel เก่า** ไปยังไฟล์ MS Project ที่เต็มรูปแบบ  
- **การรายงานบนเซิร์ฟเวอร์** ที่บริการเว็บส่งไฟล์ MPP ตามคำขอ  

## การแก้ไขปัญหาและข้อผิดพลาดที่พบบ่อย

| ปัญหา | สาเหตุ | วิธีแก้ |
|-------|-------|--------|
| `NullPointerException` ที่ `project.save` | `dataDir` ชี้ไปยังโฟลเดอร์ที่ไม่มีอยู่ | ตรวจสอบให้โฟลเดอร์มีอยู่หรือสร้างขึ้นโดยโปรแกรม |
| ปฏิทินไม่ถูกนำไปใช้กับงาน | งานยังอ้างอิงปฏิทินเริ่มต้น | หลังจากตั้งค่า `Prj.CALENDAR` แล้ว ให้อัปเดต `Task.CALENDAR` ของแต่ละงานหากเคยถูกกำหนดค่าไว้ก่อน |
| ไฟล์ผลลัพธ์เป็น 0 KB | ไม่มีสิทธิ์เขียนไฟล์ | รัน JVM ด้วยสิทธิ์ไฟล์ที่เหมาะสมหรือเลือกพาธที่สามารถเขียนได้ |

## คำถามที่พบบ่อย

**ถาม: Aspose.Tasks for Java รองรับเวอร์ชันของ MS Project ต่าง ๆ หรือไม่?**  
ตอบ: ใช่, Aspose.Tasks for Java รองรับช่วงเวอร์ชันของ MS Project ตั้งแต่ Project 2007 จนถึงรุ่นล่าสุด ทำให้ความเข้ากันได้เป็นเรื่องราบรื่น

**ถาม: สามารถปรับแต่งปฏิทินให้ตรงกับความต้องการของโครงการได้หรือไม่?**  
ตอบ: แน่นอน คุณสามารถกำหนดวันทำงาน, สัปดาห์ทำงานแบบกำหนดเอง, เพิ่มวันหยุด, และแม้กระทั่งสร้างหลายปฏิทินในไฟล์โครงการเดียวได้

**ถาม: Aspose.Tasks for Java มีการสนับสนุนการแก้ไขปัญหาและช่วยเหลือหรือไม่?**  
ตอบ: มี, คุณสามารถขอความช่วยเหลือจากฟอรั่มชุมชน Aspose.Tasks ได้ [ที่นี่](https://forum.aspose.com/c/tasks/15)

**ถาม: มีรุ่นทดลองฟรีสำหรับ Aspose.Tasks for Java หรือไม่?**  
ตอบ: มี, คุณสามารถดาวน์โหลดรุ่นทดลองที่ใช้งานเต็มรูปแบบได้ [ที่นี่](https://releases.aspose.com/)

**ถาม: จะขอรับลิขสิทธิ์ชั่วคราวสำหรับ Aspose.Tasks for Java ได้อย่างไร?**  
ตอบ: สามารถขอรับลิขสิทธิ์ชั่วคราวได้ผ่านเว็บไซต์ Aspose [ที่นี่](https://purchase.aspose.com/temporary-license/)

---

**อัปเดตล่าสุด:** 2025-12-03  
**ทดสอบด้วย:** Aspose.Tasks for Java 24.12  
**ผู้เขียน:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}